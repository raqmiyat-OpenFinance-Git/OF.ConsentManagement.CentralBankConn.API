<?xml version="1.0" encoding="UTF-8"?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.nlog-project.org/schemas/NLog.xsd NLog.xsd" autoReload="true" throwExceptions="false" internalLogLevel="Error" internalLogFile="${Logedir}./nlog-internal.txt">
  <variable name="Logedir" value="D:\Logs\ConsentEventService\" />
  <targets>
    <target name="OF.ConsentManagement.CentralBankConn.API" xsi:type="File" layout="Timestamp: ${longdate} |${level:uppercase=true}| ${message}"
            fileName="${Logedir}/OF.ConsentManagement.CentralBankConn.API/OF.ConsentManagement.CentralBankConn.API.txt"
            archiveAboveSize="2000000"
            archiveFileName="${Logedir}/OF.ConsentManagement.CentralBankConn.API/Archives/OF.ConsentManagement.CentralBankConn.API.{#}.txt"
            archiveDateFormat="yyyy-MM-dd HH_mm_ss"
            archiveNumbering="Date"
            maxArchiveDays="1"
            concurrentWrites="true"
            keepFileOpen="true"
            openFileCacheTimeout="30" />
    <target name="Consent" xsi:type="File" layout="Timestamp: ${longdate} |${level:uppercase=true}| ${message}"
         fileName="${Logedir}/Consent/Consent.txt"
         archiveAboveSize="2000000"
         archiveFileName="${Logedir}/Consent/Archives/Consent.{#}.txt"
         archiveDateFormat="yyyy-MM-dd HH_mm_ss"
         archiveNumbering="Date"
         maxArchiveDays="1"
         concurrentWrites="true"
         keepFileOpen="true"
         openFileCacheTimeout="30" />
    <target name="ConsentJson" xsi:type="File"
            fileName="${Logedir}/ConsentJson/ConsentJson.json"
            encoding="utf-8"
            archiveEvery="Day"
            maxArchiveFiles="7"
            concurrentWrites="true"
            keepFileOpen="false">
      
      <layout xsi:type="JsonLayout" includeAllProperties="true" renderEmptyObject="false">
        <attribute name="time" layout="${longdate}" />
        <attribute name="level" layout="${level:upperCase=true}" />
        <attribute name="logger" layout="${logger}" />
        <attribute name="message" layout="${message}" />
        <attribute name="stackTrace" layout="${exception:format=ToString}" />
      </layout>
    </target>
    <target name="ResourceLogApi" xsi:type="File" layout="Timestamp: ${longdate} |${level:uppercase=true}| ${message}"
             fileName="${Logedir}/ResourceLogApi/ResourceLogApi.txt"
             archiveAboveSize="2000000"
             archiveFileName="${Logedir}/ResourceLogApi/Archives/ResourceLogApi.{#}.txt"
             archiveDateFormat="yyyy-MM-dd HH_mm_ss"
             archiveNumbering="Date"
             maxArchiveDays="1"
             concurrentWrites="true"
             keepFileOpen="true"
             openFileCacheTimeout="30" />
    <target name="ResourceLogApiJson" xsi:type="File"
            fileName="${Logedir}/ResourceLogApiJson/ResourceLogApiJson.json"
            encoding="utf-8"
            archiveEvery="Day"
            maxArchiveFiles="7"
            concurrentWrites="true"
            keepFileOpen="false">

      <layout xsi:type="JsonLayout" includeAllProperties="true" renderEmptyObject="false">
        <attribute name="time" layout="${longdate}" />
        <attribute name="level" layout="${level:upperCase=true}" />
        <attribute name="logger" layout="${logger}" />
        <attribute name="message" layout="${message}" />
        <attribute name="stackTrace" layout="${exception:format=ToString}" />
      </layout>
    </target>
  </targets>
  <rules>
    <!-- Optional: add plain text logging too -->
    <logger name="OF.ConsentManagement.CentralBankConn.APILogger" minlevel="Info" writeTo="OF.ConsentManagement.CentralBankConn.API" />
    <logger name="ConsentLogger" minlevel="Info" writeTo="Consent" />
    <logger name="ConsentJsonLogger" minlevel="Info" writeTo="ConsentJson" />
    <logger name="ResourceLogApiLogger" minlevel="Info" writeTo="ResourceLogApi" />
    <logger name="ResourceLogApiJsonLogger" minlevel="Info" writeTo="ResourceLogApiJson" />
    
  </rules>
  <extensions>
    <add assembly="NLog.Web.AspNetCore" />
  </extensions>
</nlog>